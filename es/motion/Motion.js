function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

import * as React from "react";
import PropTypes from "prop-types";
import Animate from "rc-animate";

var noop = function noop() {};

var MOTION_DURATION_BASE = 200;
var transitionNames = {
  slide: "slide-up",
  zoom: "zoom-motion",
  zoomHorizontal: "zoom-motion-horizontal"
};

var Motion = function Motion(_ref) {
  var afterLeave = _ref.afterLeave,
      animation = _ref.animation,
      _appear = _ref.appear,
      children = _ref.children,
      duration = _ref.duration,
      onLeave = _ref.onLeave,
      transition = _ref.transition,
      othersProps = _objectWithoutProperties(_ref, ["afterLeave", "animation", "appear", "children", "duration", "onLeave", "transition"]);

  var dur = duration !== null && duration !== undefined ? duration : MOTION_DURATION_BASE;
  var transitionName = transition && transitionNames[transition];

  var getNodeStyle = function getNodeStyle(node, styleName) {
    return getComputedStyle(node).getPropertyValue(styleName);
  };

  var setNodeStyle = function setNodeStyle(node) {
    if (node) {
      if (transitionName && transitionName.includes("horizontal")) {
        node.style.marginRight = "0";
        node.style.marginLeft = "0";
        node.style.paddingRight = "0";
        node.style.paddingLeft = "0";
        node.style.width = "0";
      } else {
        node.style.marginTop = "0";
        node.style.marginBottom = "0";
        node.style.paddingTop = "0";
        node.style.paddingBottom = "0";
        node.style.height = "0";
      }
    }
  };

  var getEnterAnimation = function getEnterAnimation(node, done) {
    var width = "".concat(node.getBoundingClientRect().width, "px");
    var height = "".concat(node.getBoundingClientRect().height, "px");
    var paddingTop = getNodeStyle(node, "padding-top");
    var paddingRight = getNodeStyle(node, "padding-right");
    var paddingBottom = getNodeStyle(node, "padding-bottom");
    var paddingLeft = getNodeStyle(node, "padding-left");

    if (transitionName && transitionName.includes("slide")) {
      node.style.opacity = "1";
    }

    if (transitionName && transitionName.includes("horizontal")) {
      node.style.width = "0";
      node.style.paddingRight = "0";
      node.style.paddingLeft = "0";
    } else {
      node.style.height = "0";
      node.style.paddingTop = "0";
      node.style.paddingBottom = "0";
    }

    node.style.overflow = "hidden";
    node.style.setProperty("animation-duration", "".concat(dur, "ms"), "important");
    node.classList.add("".concat(transitionName, "-enter"), "".concat(transitionName, "-enter-active"));
    setTimeout(function () {
      if (transitionName && transitionName.includes("horizontal")) {
        node.style.transition = "all ".concat(dur, "ms var(--ease-in-out)");
        node.style.width = width;
        node.style.paddingRight = paddingRight;
        node.style.paddingLeft = paddingLeft;
      } else {
        node.style.transition = "all ".concat(dur, "ms var(--ease-in-out)");
        node.style.height = height;
        node.style.paddingTop = paddingTop;
        node.style.paddingBottom = paddingBottom;
      }
    }, 10);
    var promise = new Promise(function (resolve) {
      return setTimeout(resolve, dur);
    });
    promise.then(function () {
      node.classList.remove("".concat(transitionName, "-enter"), "".concat(transitionName, "-enter-active"));

      if (transitionName && transitionName.includes("horizontal")) {
        node.style.width = "";
      } else {
        node.style.height = "";
      }

      node.style.overflow = "";
      return done();
    });
  };

  return React.createElement(Animate, _extends({
    animation: animation || {
      appear: function appear(node, done) {
        if (_appear) {
          getEnterAnimation(node, done);
        }

        return done();
      },
      enter: function enter(node, done) {
        getEnterAnimation(node, done);
      },
      leave: function leave(node, done) {
        if (onLeave) {
          onLeave(node);
        }

        if (transitionName && transitionName.includes("horizontal")) {
          var width = "".concat(node.getBoundingClientRect().width, "px");
          node.style.width = width;
        } else {
          var height = "".concat(node.getBoundingClientRect().height, "px");
          node.style.height = height;
        }

        node.style.setProperty("animation-duration", "".concat(dur, "ms"), "important");
        node.style.overflow = "hidden";
        node.classList.remove("".concat(transitionName, "-enter"), "".concat(transitionName, "-enter-active"));
        node.classList.add("".concat(transitionName, "-leave"), "".concat(transitionName, "-leave-active"));
        setTimeout(function () {
          node.style.transition = "all ".concat(dur, "ms var(--ease-in-out)");
          setNodeStyle(node);
        }, 10);
        var promise = new Promise(function (resolve) {
          return setTimeout(resolve, dur);
        });
        promise.then(function () {
          if (afterLeave) {
            afterLeave(node);
          }

          return done();
        });
      }
    }
  }, othersProps), children);
};

Motion.propTypes = {
  afterLeave: PropTypes.func,
  animation: PropTypes.object,
  appear: PropTypes.bool,
  children: PropTypes.node,
  duration: PropTypes.number,
  onLeave: PropTypes.func,
  transition: PropTypes.oneOf(["slide", "zoom", "zoomHorizontal"])
};
Motion.defaultProps = {
  afterLeave: noop,
  animation: undefined,
  appear: false,
  children: null,
  duration: undefined,
  onLeave: noop,
  transition: "zoom"
};
export default Motion;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2NvbXBvbmVudHMvbW90aW9uL01vdGlvbi50c3giXSwibmFtZXMiOlsiUmVhY3QiLCJQcm9wVHlwZXMiLCJBbmltYXRlIiwibm9vcCIsIk1PVElPTl9EVVJBVElPTl9CQVNFIiwidHJhbnNpdGlvbk5hbWVzIiwic2xpZGUiLCJ6b29tIiwiem9vbUhvcml6b250YWwiLCJNb3Rpb24iLCJhZnRlckxlYXZlIiwiYW5pbWF0aW9uIiwiYXBwZWFyIiwiY2hpbGRyZW4iLCJkdXJhdGlvbiIsIm9uTGVhdmUiLCJ0cmFuc2l0aW9uIiwib3RoZXJzUHJvcHMiLCJkdXIiLCJ1bmRlZmluZWQiLCJ0cmFuc2l0aW9uTmFtZSIsImdldE5vZGVTdHlsZSIsIm5vZGUiLCJzdHlsZU5hbWUiLCJnZXRDb21wdXRlZFN0eWxlIiwiZ2V0UHJvcGVydHlWYWx1ZSIsInNldE5vZGVTdHlsZSIsImluY2x1ZGVzIiwic3R5bGUiLCJtYXJnaW5SaWdodCIsIm1hcmdpbkxlZnQiLCJwYWRkaW5nUmlnaHQiLCJwYWRkaW5nTGVmdCIsIndpZHRoIiwibWFyZ2luVG9wIiwibWFyZ2luQm90dG9tIiwicGFkZGluZ1RvcCIsInBhZGRpbmdCb3R0b20iLCJoZWlnaHQiLCJnZXRFbnRlckFuaW1hdGlvbiIsImRvbmUiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJvcGFjaXR5Iiwib3ZlcmZsb3ciLCJzZXRQcm9wZXJ0eSIsImNsYXNzTGlzdCIsImFkZCIsInNldFRpbWVvdXQiLCJwcm9taXNlIiwiUHJvbWlzZSIsInJlc29sdmUiLCJ0aGVuIiwicmVtb3ZlIiwiZW50ZXIiLCJsZWF2ZSIsInByb3BUeXBlcyIsImZ1bmMiLCJvYmplY3QiLCJib29sIiwibnVtYmVyIiwib25lT2YiLCJkZWZhdWx0UHJvcHMiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLE9BQU8sS0FBS0EsS0FBWixNQUF1QixPQUF2QjtBQUNBLE9BQU9DLFNBQVAsTUFBc0IsWUFBdEI7QUFDQSxPQUFPQyxPQUFQLE1BQW9C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Q0FBaEI7QUFQSyxDQUFuQjtBQVVBbkQsTUFBTSxDQUFDb0QsWUFBUCxHQUFzQjtBQUNwQm5ELEVBQUFBLFVBQVUsRUFBRVAsSUFEUTtBQUVwQlEsRUFBQUEsU0FBUyxFQUFFUSxTQUZTO0FBR3BCUCxFQUFBQSxNQUFNLEVBQUUsS0FIWTtBQUlwQkMsRUFBQUEsUUFBUSxFQUFFLElBSlU7QUFLcEJDLEVBQUFBLFFBQVEsRUFBRUssU0FMVTtBQU1wQkosRUFBQUEsT0FBTyxFQUFFWixJQU5XO0FBT3BCYSxFQUFBQSxVQUFVLEVBQUU7QUFQUSxDQUF0QjtBQVVBLGVBQWVQLE1BQWYiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tIFwicmVhY3RcIlxuaW1wb3J0IFByb3BUeXBlcyBmcm9tIFwicHJvcC10eXBlc1wiXG5pbXBvcnQgQW5pbWF0ZSBmcm9tIFwicmMtYW5pbWF0ZVwiXG5cbmNvbnN0IG5vb3AgPSAoKSA9PiB7fVxuY29uc3QgTU9USU9OX0RVUkFUSU9OX0JBU0UgPSAyMDBcbmNvbnN0IHRyYW5zaXRpb25OYW1lcyA9IHtcbiAgc2xpZGU6IFwic2xpZGUtdXBcIixcbiAgem9vbTogXCJ6b29tLW1vdGlvblwiLFxuICB6b29tSG9yaXpvbnRhbDogXCJ6b29tLW1vdGlvbi1ob3Jpem9udGFsXCIsXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSU1vdGlvblByb3BzIHtcbiAgW2tleTogc3RyaW5nXTogYW55XG4gIC8qKlxuICAgKiBkb20g56e76Zmk5ZCO55qEIGhhbmRsZXJcbiAgICovXG4gIGFmdGVyTGVhdmU/OiAobm9kZTogSFRNTEVsZW1lbnQpID0+IHZvaWRcbiAgLyoqXG4gICAqIOWPr+iHquWumuS5iSBhbmltYXRpb24g55qEIGFwcGVhciwgZW50ZXIsIGxlYXZlXG4gICAqL1xuICBhbmltYXRpb24/OiBvYmplY3RcbiAgLyoqXG4gICAqIOi/m+WFpeWKqOeUu+aYr+WQpuS9nOeUqOS6jiBhcHBlYXIg6Zi25q61XG4gICAqL1xuICBhcHBlYXI/OiBib29sZWFuXG4gIC8qKlxuICAgKiDlrZDlhYPntKBcbiAgICovXG4gIGNoaWxkcmVuPzogUmVhY3QuUmVhY3ROb2RlXG4gIC8qKlxuICAgKiBNb3Rpb24g5YyF6KO55bGC55qE5YWD57Sg5qCH562+XG4gICAqL1xuICBjb21wb25lbnQ/OiBzdHJpbmdcbiAgLyoqXG4gICAqIOWKqOaViOaMgee7reaXtumXtO+8jOWNleS9jSBtc1xuICAgKi9cbiAgZHVyYXRpb24/OiBudW1iZXJcbiAgLyoqXG4gICAqIGRvbSDlvIDlp4vnp7vpmaTnmoQgaGFuZGxlclxuICAgKi9cbiAgb25MZWF2ZT86IChub2RlOiBIVE1MRWxlbWVudCkgPT4gdm9pZFxuICAvKipcbiAgICog5Yqo5pWI5b2i5byPXG4gICAqL1xuICB0cmFuc2l0aW9uPzogXCJzbGlkZVwiIHwgXCJ6b29tXCIgfCBcInpvb21Ib3Jpem9udGFsXCJcbn1cblxuY29uc3QgTW90aW9uOiBSZWFjdC5GQzxJTW90aW9uUHJvcHM+ID0gKHtcbiAgYWZ0ZXJMZWF2ZSxcbiAgYW5pbWF0aW9uLFxuICBhcHBlYXIsXG4gIGNoaWxkcmVuLFxuICBkdXJhdGlvbixcbiAgb25MZWF2ZSxcbiAgdHJhbnNpdGlvbixcbiAgLi4ub3RoZXJzUHJvcHNcbn06IElNb3Rpb25Qcm9wcykgPT4ge1xuICBjb25zdCBkdXIgPVxuICAgIGR1cmF0aW9uICE9PSBudWxsICYmIGR1cmF0aW9uICE9PSB1bmRlZmluZWRcbiAgICAgID8gZHVyYXRpb25cbiAgICAgIDogTU9USU9OX0RVUkFUSU9OX0JBU0VcbiAgY29uc3QgdHJhbnNpdGlvbk5hbWUgPSB0cmFuc2l0aW9uICYmIHRyYW5zaXRpb25OYW1lc1t0cmFuc2l0aW9uXVxuXG4gIGNvbnN0IGdldE5vZGVTdHlsZSA9IChub2RlOiBIVE1MRWxlbWVudCwgc3R5bGVOYW1lOiBzdHJpbmcpID0+XG4gICAgZ2V0Q29tcHV0ZWRTdHlsZShub2RlKS5nZXRQcm9wZXJ0eVZhbHVlKHN0eWxlTmFtZSlcblxuICBjb25zdCBzZXROb2RlU3R5bGUgPSAobm9kZTogSFRNTEVsZW1lbnQpID0+IHtcbiAgICBpZiAobm9kZSkge1xuICAgICAgaWYgKHRyYW5zaXRpb25OYW1lICYmIHRyYW5zaXRpb25OYW1lLmluY2x1ZGVzKFwiaG9yaXpvbnRhbFwiKSkge1xuICAgICAgICBub2RlLnN0eWxlLm1hcmdpblJpZ2h0ID0gXCIwXCJcbiAgICAgICAgbm9kZS5zdHlsZS5tYXJnaW5MZWZ0ID0gXCIwXCJcbiAgICAgICAgbm9kZS5zdHlsZS5wYWRkaW5nUmlnaHQgPSBcIjBcIlxuICAgICAgICBub2RlLnN0eWxlLnBhZGRpbmdMZWZ0ID0gXCIwXCJcbiAgICAgICAgbm9kZS5zdHlsZS53aWR0aCA9IFwiMFwiXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBub2RlLnN0eWxlLm1hcmdpblRvcCA9IFwiMFwiXG4gICAgICAgIG5vZGUuc3R5bGUubWFyZ2luQm90dG9tID0gXCIwXCJcbiAgICAgICAgbm9kZS5zdHlsZS5wYWRkaW5nVG9wID0gXCIwXCJcbiAgICAgICAgbm9kZS5zdHlsZS5wYWRkaW5nQm90dG9tID0gXCIwXCJcbiAgICAgICAgbm9kZS5zdHlsZS5oZWlnaHQgPSBcIjBcIlxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGNvbnN0IGdldEVudGVyQW5pbWF0aW9uID0gKG5vZGU6IEhUTUxFbGVtZW50LCBkb25lOiAoKSA9PiB2b2lkKSA9PiB7XG4gICAgY29uc3Qgd2lkdGggPSBgJHtub2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRofXB4YFxuICAgIGNvbnN0IGhlaWdodCA9IGAke25vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0fXB4YFxuICAgIGNvbnN0IHBhZGRpbmdUb3AgPSBnZXROb2RlU3R5bGUobm9kZSwgXCJwYWRkaW5nLXRvcFwiKVxuICAgIGNvbnN0IHBhZGRpbmdSaWdodCA9IGdldE5vZGVTdHlsZShub2RlLCBcInBhZGRpbmctcmlnaHRcIilcbiAgICBjb25zdCBwYWRkaW5nQm90dG9tID0gZ2V0Tm9kZVN0eWxlKG5vZGUsIFwicGFkZGluZy1ib3R0b21cIilcbiAgICBjb25zdCBwYWRkaW5nTGVmdCA9IGdldE5vZGVTdHlsZShub2RlLCBcInBhZGRpbmctbGVmdFwiKVxuXG4gICAgaWYgKHRyYW5zaXRpb25OYW1lICYmIHRyYW5zaXRpb25OYW1lLmluY2x1ZGVzKFwic2xpZGVcIikpIHtcbiAgICAgIG5vZGUuc3R5bGUub3BhY2l0eSA9IFwiMVwiXG4gICAgfVxuXG4gICAgaWYgKHRyYW5zaXRpb25OYW1lICYmIHRyYW5zaXRpb25OYW1lLmluY2x1ZGVzKFwiaG9yaXpvbnRhbFwiKSkge1xuICAgICAgbm9kZS5zdHlsZS53aWR0aCA9IFwiMFwiXG4gICAgICBub2RlLnN0eWxlLnBhZGRpbmdSaWdodCA9IFwiMFwiXG4gICAgICBub2RlLnN0eWxlLnBhZGRpbmdMZWZ0ID0gXCIwXCJcbiAgICB9IGVsc2Uge1xuICAgICAgbm9kZS5zdHlsZS5oZWlnaHQgPSBcIjBcIlxuICAgICAgbm9kZS5zdHlsZS5wYWRkaW5nVG9wID0gXCIwXCJcbiAgICAgIG5vZGUuc3R5bGUucGFkZGluZ0JvdHRvbSA9IFwiMFwiXG4gICAgfVxuXG4gICAgbm9kZS5zdHlsZS5vdmVyZmxvdyA9IFwiaGlkZGVuXCJcbiAgICBub2RlLnN0eWxlLnNldFByb3BlcnR5KFwiYW5pbWF0aW9uLWR1cmF0aW9uXCIsIGAke2R1cn1tc2AsIFwiaW1wb3J0YW50XCIpXG4gICAgbm9kZS5jbGFzc0xpc3QuYWRkKFxuICAgICAgYCR7dHJhbnNpdGlvbk5hbWV9LWVudGVyYCxcbiAgICAgIGAke3RyYW5zaXRpb25OYW1lfS1lbnRlci1hY3RpdmVgXG4gICAgKVxuXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBpZiAodHJhbnNpdGlvbk5hbWUgJiYgdHJhbnNpdGlvbk5hbWUuaW5jbHVkZXMoXCJob3Jpem9udGFsXCIpKSB7XG4gICAgICAgIG5vZGUuc3R5bGUudHJhbnNpdGlvbiA9IGBhbGwgJHtkdXJ9bXMgdmFyKC0tZWFzZS1pbi1vdXQpYFxuICAgICAgICBub2RlLnN0eWxlLndpZHRoID0gd2lkdGhcbiAgICAgICAgbm9kZS5zdHlsZS5wYWRkaW5nUmlnaHQgPSBwYWRkaW5nUmlnaHRcbiAgICAgICAgbm9kZS5zdHlsZS5wYWRkaW5nTGVmdCA9IHBhZGRpbmdMZWZ0XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBub2RlLnN0eWxlLnRyYW5zaXRpb24gPSBgYWxsICR7ZHVyfW1zIHZhcigtLWVhc2UtaW4tb3V0KWBcbiAgICAgICAgbm9kZS5zdHlsZS5oZWlnaHQgPSBoZWlnaHRcbiAgICAgICAgbm9kZS5zdHlsZS5wYWRkaW5nVG9wID0gcGFkZGluZ1RvcFxuICAgICAgICBub2RlLnN0eWxlLnBhZGRpbmdCb3R0b20gPSBwYWRkaW5nQm90dG9tXG4gICAgICB9XG4gICAgfSwgMTApXG4gICAgY29uc3QgcHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIGR1cikpXG4gICAgcHJvbWlzZS50aGVuKCgpID0+IHtcbiAgICAgIG5vZGUuY2xhc3NMaXN0LnJlbW92ZShcbiAgICAgICAgYCR7dHJhbnNpdGlvbk5hbWV9LWVudGVyYCxcbiAgICAgICAgYCR7dHJhbnNpdGlvbk5hbWV9LWVudGVyLWFjdGl2ZWBcbiAgICAgIClcbiAgICAgIGlmICh0cmFuc2l0aW9uTmFtZSAmJiB0cmFuc2l0aW9uTmFtZS5pbmNsdWRlcyhcImhvcml6b250YWxcIikpIHtcbiAgICAgICAgbm9kZS5zdHlsZS53aWR0aCA9IFwiXCJcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG5vZGUuc3R5bGUuaGVpZ2h0ID0gXCJcIlxuICAgICAgfVxuICAgICAgbm9kZS5zdHlsZS5vdmVyZmxvdyA9IFwiXCJcbiAgICAgIHJldHVybiBkb25lKClcbiAgICB9KVxuICB9XG5cbiAgcmV0dXJuIChcbiAgICA8QW5pbWF0ZVxuICAgICAgYW5pbWF0aW9uPXtcbiAgICAgICAgYW5pbWF0aW9uIHx8IHtcbiAgICAgICAgICBhcHBlYXIobm9kZTogSFRNTEVsZW1lbnQsIGRvbmU6ICgpID0+IHZvaWQpIHtcbiAgICAgICAgICAgIGlmIChhcHBlYXIpIHtcbiAgICAgICAgICAgICAgZ2V0RW50ZXJBbmltYXRpb24obm9kZSwgZG9uZSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBkb25lKClcbiAgICAgICAgICB9LFxuICAgICAgICAgIGVudGVyKG5vZGU6IEhUTUxFbGVtZW50LCBkb25lOiAoKSA9PiB2b2lkKSB7XG4gICAgICAgICAgICBnZXRFbnRlckFuaW1hdGlvbihub2RlLCBkb25lKVxuICAgICAgICAgIH0sXG4gICAgICAgICAgbGVhdmUobm9kZTogSFRNTEVsZW1lbnQsIGRvbmU6ICgpID0+IHZvaWQpIHtcbiAgICAgICAgICAgIGlmIChvbkxlYXZlKSB7XG4gICAgICAgICAgICAgIG9uTGVhdmUobm9kZSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0cmFuc2l0aW9uTmFtZSAmJiB0cmFuc2l0aW9uTmFtZS5pbmNsdWRlcyhcImhvcml6b250YWxcIikpIHtcbiAgICAgICAgICAgICAgY29uc3Qgd2lkdGggPSBgJHtub2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRofXB4YFxuICAgICAgICAgICAgICBub2RlLnN0eWxlLndpZHRoID0gd2lkdGhcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGNvbnN0IGhlaWdodCA9IGAke25vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0fXB4YFxuICAgICAgICAgICAgICBub2RlLnN0eWxlLmhlaWdodCA9IGhlaWdodFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbm9kZS5zdHlsZS5zZXRQcm9wZXJ0eShcbiAgICAgICAgICAgICAgXCJhbmltYXRpb24tZHVyYXRpb25cIixcbiAgICAgICAgICAgICAgYCR7ZHVyfW1zYCxcbiAgICAgICAgICAgICAgXCJpbXBvcnRhbnRcIlxuICAgICAgICAgICAgKVxuICAgICAgICAgICAgbm9kZS5zdHlsZS5vdmVyZmxvdyA9IFwiaGlkZGVuXCJcbiAgICAgICAgICAgIG5vZGUuY2xhc3NMaXN0LnJlbW92ZShcbiAgICAgICAgICAgICAgYCR7dHJhbnNpdGlvbk5hbWV9LWVudGVyYCxcbiAgICAgICAgICAgICAgYCR7dHJhbnNpdGlvbk5hbWV9LWVudGVyLWFjdGl2ZWBcbiAgICAgICAgICAgIClcbiAgICAgICAgICAgIG5vZGUuY2xhc3NMaXN0LmFkZChcbiAgICAgICAgICAgICAgYCR7dHJhbnNpdGlvbk5hbWV9LWxlYXZlYCxcbiAgICAgICAgICAgICAgYCR7dHJhbnNpdGlvbk5hbWV9LWxlYXZlLWFjdGl2ZWBcbiAgICAgICAgICAgIClcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICBub2RlLnN0eWxlLnRyYW5zaXRpb24gPSBgYWxsICR7ZHVyfW1zIHZhcigtLWVhc2UtaW4tb3V0KWBcbiAgICAgICAgICAgICAgc2V0Tm9kZVN0eWxlKG5vZGUpXG4gICAgICAgICAgICB9LCAxMClcbiAgICAgICAgICAgIGNvbnN0IHByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dChyZXNvbHZlLCBkdXIpKVxuICAgICAgICAgICAgcHJvbWlzZS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgaWYgKGFmdGVyTGVhdmUpIHtcbiAgICAgICAgICAgICAgICBhZnRlckxlYXZlKG5vZGUpXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcmV0dXJuIGRvbmUoKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9LFxuICAgICAgICB9XG4gICAgICB9XG4gICAgICB7Li4ub3RoZXJzUHJvcHN9XG4gICAgPlxuICAgICAge2NoaWxkcmVufVxuICAgIDwvQW5pbWF0ZT5cbiAgKVxufVxuXG5Nb3Rpb24ucHJvcFR5cGVzID0ge1xuICBhZnRlckxlYXZlOiBQcm9wVHlwZXMuZnVuYyxcbiAgYW5pbWF0aW9uOiBQcm9wVHlwZXMub2JqZWN0LFxuICBhcHBlYXI6IFByb3BUeXBlcy5ib29sLFxuICBjaGlsZHJlbjogUHJvcFR5cGVzLm5vZGUsXG4gIGR1cmF0aW9uOiBQcm9wVHlwZXMubnVtYmVyLFxuICBvbkxlYXZlOiBQcm9wVHlwZXMuZnVuYyxcbiAgdHJhbnNpdGlvbjogUHJvcFR5cGVzLm9uZU9mKFtcInNsaWRlXCIsIFwiem9vbVwiLCBcInpvb21Ib3Jpem9udGFsXCJdKSxcbn1cblxuTW90aW9uLmRlZmF1bHRQcm9wcyA9IHtcbiAgYWZ0ZXJMZWF2ZTogbm9vcCxcbiAgYW5pbWF0aW9uOiB1bmRlZmluZWQsXG4gIGFwcGVhcjogZmFsc2UsXG4gIGNoaWxkcmVuOiBudWxsLFxuICBkdXJhdGlvbjogdW5kZWZpbmVkLFxuICBvbkxlYXZlOiBub29wLFxuICB0cmFuc2l0aW9uOiBcInpvb21cIixcbn1cblxuZXhwb3J0IGRlZmF1bHQgTW90aW9uXG4iXX0=